	OPTION	OFFSET:GROUP
	PUBLIC	FCRYPEXP,ONEBITCNT
DGROUP	GROUP	ASMEXT_DATA
ASMEXT_TEXT	SEGMENT	PARA	PUBLIC	'CODE'
	ASSUME	CS:ASMEXT_TEXT,DS:DGROUP,ES:NOTHING,SS:DGROUP
FCRYPEXP	PROC	FAR
	PUSH	BP
	PUSH	SI
	MOV	BP,SP
	MOV	SI,[BP+0EH]
	MOV	AX,[SI]
	MOV	SI,[BP+0CH]
	MOV	DX,[SI]
	MOV	SI,[BP+0AH]
	MOV	BX,[SI]
	MOV	SI,[BP+8]
	MOV	CX,[SI]
	XOR	CX,AX
	XOR	CX,DX
	XOR	CX,BX
	ROL	AL,1
	ROR	AH,1
	ADD	DH,AL
	ADD	DL,AH
	ROL	DL,1
	ROR	DH,1
	ADD	BH,DL
	ADD	BL,DH
	ROL	BL,1
	ROR	BH,1
	ADD	AH,BL
	ADD	AL,BH
	MOV	SI,[BP+0EH]
	MOV	[SI],AX
	MOV	SI,[BP+0CH]
	MOV	[SI],DX
	MOV	SI,[BP+0AH]
	MOV	[SI],BX
	MOV	SI,[BP+8]
	MOV	[SI],CX
	POP	SI
	POP	BP
	RET	8
FCRYPEXP	ENDP
ONEBITCNT	PROC	FAR
	PUSH	BP
	MOV	BP,SP
	MOV	DX,[BP+6]
	XOR	AX,AX
	MOV	CX,10H
@@:	SHR	DX,1
	ADC	AX,0
	LOOP	@B
	POP	BP
	RET	2
ONEBITCNT	ENDP
ASMEXT_TEXT	ENDS
ASMEXT_DATA	SEGMENT	WORD	PUBLIC	'DATA'
ASMEXT_DATA	ENDS
	END
