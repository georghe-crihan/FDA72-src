	.286
	OPTION	OFFSET:GROUP
	PUBLIC	BITRUN
	EXTRN	_CRC16T:WORD
DGROUP	GROUP	SWINDRV_DATA
SWINDRV_TEXT	SEGMENT	PARA	PUBLIC	'CODE'
	ASSUME	CS:SWINDRV_TEXT,DS:DGROUP,ES:NOTHING,SS:DGROUP
BITRUN	PROC	FAR
	PUSH	BP
	PUSH	SI
	PUSH	DI
	MOV	BP,SP
	LES	SI,[BP+0CH]
	MOV	AX,[BP+0AH]
	MOV	CX,202H
	MOV	BP,1011H
	SUB	BP,AX
	MOV	DX,1
	CMP	AX,1
	JE	@F
	MOV	DX,3
@@:	MOV	AX,0E295H
	LEA	DI,[_CRC16T]
GLOCYC:	XOR	ES:[SI],DX
	PUSH	AX
	PUSH	CX
	PUSH	SI
@@:	MOV	BL,ES:[SI]
	INC	SI
	XOR	BL,AH
	XOR	BH,BH
	SHL	BX,1
	MOV	AH,AL
	XOR	AL,AL
	XOR	AX,[BX+DI]
	LOOP	@B
	TEST	AX,AX
	JNZ	@F
	ADD	SP,6
	POP	DI
	POP	SI
	POP	BP
	RET	6
@@:	POP	SI
	POP	CX
	POP	AX
	XOR	ES:[SI],DX
	SHL	DX,1
	TEST	DL,DL
	JNZ	GLONXT
	XCHG	DL,DH
	MOV	BL,ES:[SI]
	XOR	BL,AH
	XOR	BH,BH
	SHL	BX,1
	MOV	AH,AL
	XOR	AL,AL
	XOR	AX,[BX+DI]
	INC	SI
	DEC	CX
GLONXT:	DEC	BP
	JNZ	GLOCYC
	MOV	AX,1
	POP	DI
	POP	SI
	POP	BP
	RET	6
BITRUN	ENDP
SWINDRV_TEXT	ENDS
SWINDRV_DATA	SEGMENT	WORD	PUBLIC	'DATA'
SWINDRV_DATA	ENDS
	END
